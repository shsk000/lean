# ローカルデータシステム

## 概要
yfinance APIの不安定性を解決するため、10年間（2012-2022）の高出来高株式データをローカルに保存し、バックテスト実行時の信頼性を確保するシステムです。

## ファイル構成
```
data/
├── config.json                    # データ設定情報
├── high_volume_symbols.json       # 高出来高銘柄リスト
└── stocks/                        # 個別銘柄CSVファイル
    ├── AAPL.csv
    ├── MSFT.csv
    └── ... (約300銘柄)
```

## 使用方法

### 1. データ収集（初回のみ）
```bash
python data_collector.py
```
- S&P500から高出来高株（約300銘柄）を自動選定
- 2012-2022年の10年間OHLCVデータをダウンロード
- ローカルCSVファイルとして保存

### 2. バックテスト実行
```bash
# 単一銘柄
python bt_runner.py --single AAPL

# 複数銘柄（ローカルデータを使用）
python bt_runner.py
```

## 主な特徴

### 信頼性向上
- ❌ **従来**: yfinance API → 不安定、取得失敗でランダムな結果
- ✅ **新システム**: ローカルCSV → 100%確実、決定的な結果

### 厳格なエラーハンドリング
- データ不備時は即座に終了（フォールバックなし）
- データ整合性チェック機能
- 必要カラム（OHLCV）の自動検証

### パフォーマンス向上
- ネットワーク通信不要
- 並列データ読み込み
- 10年間の豊富なデータで統計的信頼性向上

## モジュール

### data_collector.py
- データ収集・管理ツール
- S&P500銘柄の自動選定
- 並列ダウンロード機能

### data_loader.py
- ローカルデータ読み込みモジュール
- 厳格なデータ検証
- backtrader形式への自動変換

### bt_runner.py（更新済み）
- yfinance依存を除去
- ローカルデータシステム統合
- デフォルト期間: 2012-2022（10年間）

## データ期間
- **開始日**: 2012-01-01
- **終了日**: 2022-12-31
- **期間**: 10年間（統計的信頼性確保）

## 注意事項
- 初回は`data_collector.py`でデータ準備が必要
- データ更新は手動実行
- 約300銘柄 × 10年分のデータサイズに注意